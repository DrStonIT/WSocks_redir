<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V2RayTun Redirect</title>
</head>
<body>
    <p>Перенаправление в приложение...</p>
    <div id="debug"></div>
    <script>
        const debug = document.getElementById('debug');
        debug.innerHTML = "Скрипт запущен<br>";

        const urlParams = new URLSearchParams(window.location.search);
        const encodedKey = urlParams.get('key');
        debug.innerHTML += `Получен ключ: ${encodedKey || 'нет ключа'}<br>`;

        if (!encodedKey) {
            debug.innerHTML += "Ошибка: ключ не передан<br>";
            document.body.innerHTML = "<p>Ошибка: ключ не найден в URL.</p>";
        } else {
            const decodedKey = decodeURIComponent(encodedKey);
            // Пробуем разные схемы
            const schemes = [
                `v2raytun://import/${decodedKey}`,  // Оригинальная схема
                `v2ray://import/${decodedKey}`,     // Альтернатива для v2rayNG
                `vless://${decodedKey}`,
                `v2raytun://${decodedKey}`,
                `v2ray://${decodedKey}`,            // Прямая vless-схема
            ];

            debug.innerHTML += "Пробуем схемы:<br>";
            schemes.forEach((url, index) => {
                debug.innerHTML += `<a href="${url}" id="link${index}">Схема ${index + 1}: ${url}</a><br>`;
            });

            // Автоматический редирект на первую схему
            window.location.href = schemes[0];

            setTimeout(() => {
                if (document.location.href === window.location.href) {
                    debug.innerHTML += "Автоматический редирект не сработал. Выберите схему выше вручную.<br>";
                }
            }, 1000);
        }
    </script>
</body>
</html>
